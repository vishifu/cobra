/*
 * This file was generated by the Gradle 'init' task.
 *
 * This project uses @Incubating APIs which are subject to change.
 */


allprojects {
    group = 'org.cobra'

    apply {
        plugin 'java-library'
    }

    java {
        toolchain {
            languageVersion = JavaLanguageVersion.of(21)
        }
    }

    repositories {
        mavenLocal()
        maven {
            url = uri('https://repo.maven.apache.org/maven2/')
        }
    }
}

subprojects {

    dependencies {
        implementation libs.org.slf4j.slf4j.api
        implementation libs.org.jetbrains.annotations

        testImplementation libs.org.junit.jupiter.junit.jupiter.engine
        testImplementation libs.org.junit.platform.junit.platform.runner
        testImplementation libs.org.mockito.mockito.core
        testRuntimeOnly libs.org.junit.platform.junit.platform.launcher

        compileOnly libs.org.lombok
        annotationProcessor libs.org.lombok
    }

    jar {
        duplicatesStrategy(DuplicatesStrategy.EXCLUDE)
    }

    configurations {
        compileOnly {
            extendsFrom annotationProcessor
        }
    }

    test {
        maxParallelForks = 3
        useJUnitPlatform()
    }

    tasks.withType(JavaCompile).configureEach {
        options.encoding = 'UTF-8'
        options.compilerArgs += "--add-exports=java.base/sun.nio.ch=ALL-UNNAMED"
    }

    tasks.withType(Test).configureEach {
        jvmArgs += "--add-exports=java.base/sun.nio.ch=ALL-UNNAMED"
    }

    tasks.withType(JavaExec).configureEach {
        jvmArgs += "--add-exports=java.base/sun.nio.ch=ALL-UNNAMED"
    }

    tasks.withType(Javadoc).configureEach {
        options.encoding = 'UTF-8'
    }
}
